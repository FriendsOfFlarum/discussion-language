{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/discussion-language/./node_modules/twemoji-basename/index.js","webpack://@fof/discussion-language/webpack/bootstrap","webpack://@fof/discussion-language/webpack/runtime/compat get default export","webpack://@fof/discussion-language/webpack/runtime/define property getters","webpack://@fof/discussion-language/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/discussion-language/webpack/runtime/make namespace object","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/models/Forum']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['tags/common/models/Tag']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@fof/discussion-language/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/discussion-language/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/discussion-language/./src/common/models/Language.js","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@fof/discussion-language/./src/common/utils/flag.js","webpack://@fof/discussion-language/./src/forum/components/Language.js","webpack://@fof/discussion-language/./src/forum/components/LanguageDiscussionModal.js","webpack://@fof/discussion-language/./src/forum/addEditLanguageModal.js","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@fof/discussion-language/./src/forum/addLanguageComposer.js","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/states/GlobalSearchState']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/utils/setRouteWithForcedRefresh']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/components/SelectDropdown']\"","webpack://@fof/discussion-language/./src/forum/components/LanguageDropdown.js","webpack://@fof/discussion-language/./src/forum/addLanguageToDiscussionList.js","webpack://@fof/discussion-language/./src/forum/components/index.js","webpack://@fof/discussion-language/./src/common/utils/index.js","webpack://@fof/discussion-language/./src/common/models/index.js","webpack://@fof/discussion-language/./src/forum/index.js","webpack://@fof/discussion-language/./src/forum/useLocalisedLastDiscussionOnTagsPage.ts"],"sourcesContent":["/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */\n/* https://github.com/twitter/twemoji/blob/gh-pages/LICENSE */\n\nmodule.exports = function (str) {\n  var r = []\n  var c = 0\n  var p = 0\n  var i = 0\n  var l = str.length\n\n  while (i < l) {\n    c = str.charCodeAt(i++)\n    if (p) {\n      r.push((0x10000 + ((p - 0xD800) << 10) + (c - 0xDC00)).toString(16))\n      p = 0\n    } else if (0xD800 <= c && c <= 0xDBFF) {\n      p = c\n    } else {\n      r.push(c.toString(16))\n    }\n  }\n\n  return r.join('-')\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Forum'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/common/models/Tag'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import Model from 'flarum/common/Model';\n\nexport default class Language extends Model {\n  code = Model.attribute('code');\n  country = Model.attribute('country');\n\n  name = Model.attribute('name');\n  emoji = Model.attribute('emoji');\n\n  apiEndpoint() {\n    return `/fof/discussion-language${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import basename from 'twemoji-basename';\nimport icon from 'flarum/common/helpers/icon';\n\nexport default (language) => {\n  if (!language) return;\n\n  const emoji = language.emoji ? language.emoji() : language;\n\n  return emoji ? (\n    <img\n      alt={(language.country && language.country()) || ''}\n      className=\"emoji\"\n      draggable=\"false\"\n      loading=\"lazy\"\n      src={`//cdn.jsdelivr.net/gh/twitter/twemoji@13/assets/72x72/${basename(emoji)}.png`}\n    />\n  ) : (\n    icon('fas fa-globe')\n  );\n};\n","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\n\nimport flag from '../../common/utils/flag';\n\nexport default class Language extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.languages = app.store.all('discussion-languages');\n    this.options = this.languages.reduce((o, lang) => {\n      o[lang.code()] = (\n        <span>\n          {flag(lang)} {lang.name()}\n        </span>\n      );\n\n      return o;\n    }, this.attrs.extra || {});\n  }\n\n  view() {\n    const { language, uppercase } = this.attrs;\n    const name = language.name() || '';\n\n    return (\n      <span>\n        {flag(language)}\n        &nbsp;\n        {uppercase ? name.toUpperCase() : name}\n      </span>\n    );\n  }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\n\nimport Language from './Language';\n\nexport default class LanguageDiscussionModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.languages = app.store.all('discussion-languages');\n\n    this.current = this.attrs.selected || (this.attrs.discussion && this.attrs.discussion.language());\n    this.selected = this.current;\n  }\n\n  className() {\n    return 'FoFLanguageDiscussionModal';\n  }\n\n  title() {\n    return this.attrs.discussion\n      ? app.translator.trans('fof-discussion-language.forum.change_language.edit_title', { title: <em>{this.attrs.discussion.title()}</em> })\n      : app.translator.trans('fof-discussion-language.forum.change_language.title');\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n        <div className=\"Form-group\">\n          {this.languages.map((language) => (\n            <Button onclick={this.select.bind(this, language)} className={`Button Button--block ${this.selected === language ? 'active' : ''}`}>\n              <Language language={language} uppercase={true} />\n            </Button>\n          ))}\n        </div>\n\n        {!this.attrs.hideSubmitButton && (\n          <div className=\"App-primaryControl\">\n            {Button.component(\n              {\n                type: 'submit',\n                className: 'Button Button--primary',\n                disabled: !this.selected || this.selected === this.current,\n                loading: this.loading,\n                icon: 'fas fa-check',\n              },\n              app.translator.trans('fof-discussion-language.forum.change_language.submit_button')\n            )}\n          </div>\n        )}\n      </div>,\n    ];\n  }\n\n  select(language) {\n    this.selected = language;\n\n    if (this.attrs.hideSubmitButton) return this.onsubmit();\n\n    m.redraw();\n  }\n\n  onsubmit(e) {\n    if (e) e.preventDefault();\n\n    const { discussion, onsubmit } = this.attrs;\n\n    this.loading = true;\n\n    if (!discussion) {\n      this.hide();\n\n      if (onsubmit) onsubmit(this.selected);\n\n      return;\n    }\n\n    const language = this.selected;\n\n    discussion\n      .save({ relationships: { language } })\n      .then(() => {\n        if (app.current instanceof DiscussionPage) {\n          app.current.stream.update();\n        }\n\n        return this.hide();\n      })\n      .catch(this.loaded.bind(this));\n  }\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport Button from 'flarum/common/components/Button';\n\nimport LanguageDiscussionModal from './components/LanguageDiscussionModal';\n\nexport default () => {\n  extend(DiscussionControls, 'moderationControls', function (items, discussion) {\n    if (discussion.canChangeLanguage()) {\n      items.add(\n        'language',\n        Button.component(\n          {\n            icon: 'fas fa-globe',\n            onclick: () => app.modal.show(LanguageDiscussionModal, { discussion }),\n          },\n          app.translator.trans('fof-discussion-language.forum.discussion_controls.change_language_button')\n        )\n      );\n    }\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","import { extend, override } from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\n\nimport LanguageDiscussionModal from './components/LanguageDiscussionModal';\nimport Language from './components/Language';\n\nconst sort = (a, b) => a.code().toLowerCase() > b.code().toLowerCase();\n\nexport default () => {\n  extend(IndexPage.prototype, 'newDiscussionAction', function (promise) {\n    const dislang = app.search.params().language;\n\n    if (dislang) {\n      promise.then((composer) => (composer.fields.language = app.store.getBy('discussion-languages', 'code', dislang)));\n    } else {\n      const localeComposer = app.forum.attribute('fof-discussion-language.composerLocaleDefault');\n      app.composer.fields.language = localeComposer ? app.store.getBy('discussion-languages', 'code', app.translator.formatter.locale) : '';\n    }\n  });\n\n  DiscussionComposer.prototype.chooseLanguage = function (hide, callback) {\n    app.modal.show(LanguageDiscussionModal, {\n      selected: this.composer.fields.language,\n      hideSubmitButton: hide,\n      onsubmit: (language) => {\n        this.composer.fields.language = language;\n        this.$('textarea').focus();\n\n        if (callback) callback();\n      },\n    });\n  };\n\n  extend(DiscussionComposer.prototype, 'headerItems', function (items) {\n    // Don't add lang item to byobu composers\n    if (this._isByobuComposer) return;\n\n    items.add(\n      'language',\n      <a className=\"DiscussionComposer-changeTags\" onclick={this.chooseLanguage.bind(this, true, null)}>\n        <span className={`LanguageLabel ${this.composer.fields.language ? '' : 'none'}`}>\n          {this.composer.fields.language\n            ? Language.component({ language: this.composer.fields.language, uppercase: true })\n            : app.translator.trans('fof-discussion-language.forum.composer_discussion.choose_language_link')}\n        </span>\n      </a>,\n      20\n    );\n  });\n\n  override(DiscussionComposer.prototype, 'onsubmit', function (original) {\n    // Don't add lang stuff to byobu composers\n    if (this._isByobuComposer) return original();\n\n    if (!this.composer.fields.language) return this.chooseLanguage(true, original);\n\n    original();\n  });\n\n  extend(DiscussionComposer.prototype, 'data', function (data) {\n    // Don't add lang stuff to byobu composers\n    if (this._isByobuComposer) return;\n\n    data.relationships = data.relationships || {};\n\n    data.relationships.language = this.composer.fields.language || app.store.all('discussion-languages').sort(sort)[0];\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionHero'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionListItem'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/GlobalSearchState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/setRouteWithForcedRefresh'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/SelectDropdown'];","import app from 'flarum/forum/app';\n\nimport Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\n\nimport Language from './Language';\nimport SelectDropdown from 'flarum/common/components/SelectDropdown';\n\nexport default class LanguageDropdown extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.languages = app.store.all('discussion-languages');\n    /**\n     * @type {Record<string, import('mithril').Component>}\n     */\n    this.options = this.languages.reduce((o, lang) => {\n      o[lang.code()] = <Language language={lang} />;\n\n      return o;\n    }, this.attrs.extra || {});\n  }\n\n  view() {\n    const defaultValue = app.forum.attribute('fof-discussion-language.showAnyLangOpt') ? 'any' : app.translator.formatter.locale;\n\n    return (\n      <SelectDropdown buttonClassName=\"Button\">\n        {Object.keys(this.options).map((langId) => {\n          const isItemSelected = this.attrs.selected ? langId === this.attrs.selected : langId === defaultValue;\n\n          return (\n            <Button active={isItemSelected} icon={isItemSelected ? 'fas fa-check' : true} onclick={this.attrs.onclick?.bind?.(this, langId)}>\n              {this.options[langId]}\n            </Button>\n          );\n        })}\n      </SelectDropdown>\n    );\n  }\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\nimport GlobalSearchState from 'flarum/forum/states/GlobalSearchState';\nimport setRouteWithForcedRefresh from 'flarum/common/utils/setRouteWithForcedRefresh';\n\nimport flag from '../common/utils/flag';\nimport LanguageDropdown from './components/LanguageDropdown';\n\nconst addLanguage = function (items) {\n  // Ignore PDs from Byobu\n  // Must be conditional call in case byobu not installed\n  if (this.attrs.discussion.isPrivateDiscussion?.()) return;\n\n  const language = this.attrs.discussion.language();\n\n  if (!language) return;\n\n  items.add(\n    'discussion-language',\n    <span>\n      {flag(language) || <i className=\"fas fa-globe\" />}\n      <code>{language.name()}</code>\n    </span>,\n    5\n  );\n};\n\nexport default () => {\n  extend(DiscussionListItem.prototype, 'infoItems', addLanguage);\n  extend(DiscussionHero.prototype, 'items', addLanguage);\n\n  extend(DiscussionListState.prototype, 'requestParams', function (params) {\n    const routeName = app.current.data.routeName;\n\n    if (routeName === 'byobuPrivate') return;\n    if (routeName === 'byobuUserPrivate') return;\n\n    params.include.push('language');\n\n    // Do not filter user discussions page as there is no dropdown\n    if (routeName === 'user.discussions') return;\n\n    // Required until https://github.com/flarum/framework/pull/3376 is released.\n    if (routeName === 'following' && params.filter.q) {\n      params.filter.q += ` is:${params.filter.subscription || 'following'}`;\n      delete params.filter.subscription;\n    }\n\n    const paramLang = app.search.params().language;\n    const locale = app.search.params().language ?? app.translator.formatter.locale;\n    const showAnyOpt = app.forum.attribute('fof-discussion-language.showAnyLangOpt');\n\n    if (params.filter.q) {\n      if (showAnyOpt) {\n        if (paramLang) {\n          params.filter.q += ' language:' + paramLang;\n        }\n      } else {\n        params.filter.q += ' language:' + locale;\n      }\n    } else {\n      if (!showAnyOpt || paramLang) {\n        params.filter.language = locale;\n      }\n    }\n  });\n\n  extend(GlobalSearchState.prototype, 'stickyParams', (params) => (params.language = m.route.param('language')));\n\n  extend(IndexPage.prototype, 'viewItems', function (items) {\n    // Don't add language controls to /private (fof/byobu)\n    if (app.current.data.routeName === 'byobuPrivate') return;\n\n    let extra, defaultSelected;\n    if (app.forum.attribute('fof-discussion-language.showAnyLangOpt')) {\n      extra = { any: app.translator.trans('fof-discussion-language.forum.index_language.any') };\n      defaultSelected = 'any';\n    } else {\n      defaultSelected = app.translator.formatter.locale;\n    }\n\n    items.add(\n      'language',\n      LanguageDropdown.component({\n        extra,\n        default: defaultSelected,\n        onclick: (key) => {\n          const params = app.search.params();\n\n          if (key === defaultSelected) delete params.language;\n          else params.language = key;\n\n          setRouteWithForcedRefresh(app.route(app.current.get('routeName'), params));\n        },\n        selected: app.search.params().language,\n      })\n    );\n  });\n};\n","import Language from './Language';\nimport LanguageDiscussionModal from './LanguageDiscussionModal';\nimport LanguageDropdown from './LanguageDropdown';\n\nexport const components = {\n  Language,\n  LanguageDiscussionModal,\n  LanguageDropdown,\n};\n","import flag from './flag';\n\nexport const utils = {\n  flag,\n};\n","import Language from './Language';\n\nexport const models = {\n  Language,\n};\n","import app from 'flarum/forum/app';\nimport Model from 'flarum/common/Model';\nimport Forum from 'flarum/common/models/Forum';\nimport Tag from 'flarum/tags/common/models/Tag';\nimport Discussion from 'flarum/common/models/Discussion';\n\nimport Language from '../common/models/Language';\n\nimport addEditLanguageModal from './addEditLanguageModal';\nimport addLanguageComposer from './addLanguageComposer';\nimport addLanguageToDiscussionList from './addLanguageToDiscussionList';\nimport useLocalisedLastDiscussionOnTagsPage from './useLocalisedLastDiscussionOnTagsPage';\n\nexport * from './components';\nexport * from '../common/utils';\nexport * from '../common/models';\n\napp.initializers.add('fof/discussion-language', () => {\n  app.store.models['discussion-languages'] = Language;\n\n  if ('flarum-tags' in flarum.extensions) Tag.prototype.localisedLastDiscussion = Model.attribute('localisedLastDiscussion');\n\n  Forum.prototype.discussionLanguages = Model.hasMany('discussionLanguages');\n  Discussion.prototype.language = Model.hasOne('language');\n  Discussion.prototype.canChangeLanguage = Model.attribute('canChangeLanguage');\n\n  addEditLanguageModal();\n  addLanguageComposer();\n  addLanguageToDiscussionList();\n  useLocalisedLastDiscussionOnTagsPage();\n});\n","import app from 'flarum/forum/app';\n\nimport Tag from 'flarum/tags/common/models/Tag';\n\nimport Discussion from 'flarum/common/models/Discussion';\nimport Model from 'flarum/common/Model';\n\nexport default function useLocalisedLastDiscussionOnTagsPage() {\n  if (!('flarum-tags' in flarum.extensions)) return;\n\n  Tag.prototype.lastPostedDiscussion = function (this: Tag) {\n    const original = Model.hasOne('lastPostedDiscussion').bind(this);\n\n    if (!app.forum.attribute('fof-discussion-language.useLocaleForTagsPageLastDiscussion')) {\n      return original();\n    }\n\n    const data = this.localisedLastDiscussion();\n\n    /**\n     * Priorities:\n     *\n     * 1. User's selected forum locale\n     * 2. Detected locale\n     * 3. First disucssion language available\n     */\n    const desiredLanguageCode =\n      app.session.user?.preferences?.()?.locale || (app.translator as any).formatter.locale || (app.forum as any).discussionLanguages()[0].code();\n\n    const desiredLanguageId = (app.forum as any)\n      .discussionLanguages()\n      .find((lang: any) => lang.code() === desiredLanguageCode)\n      ?.id();\n\n    // If forum locale not available as a discussion lang, default to any language\n    if (!desiredLanguageId) {\n      return original();\n    }\n\n    const discussion = data[desiredLanguageId];\n\n    // fall back to original attribute\n    if (!discussion) return original();\n\n    return new Discussion({\n      attributes: {\n        title: discussion.title,\n        slug: discussion.id, // navigating using only ID works fine\n        lastPostedAt: new Date(discussion.at * 1000).toISOString(),\n      },\n    });\n  };\n}\n"],"names":["module","exports","str","r","c","p","i","l","length","charCodeAt","push","toString","join","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","create","constructor","Language","code","Model","country","name","emoji","apiEndpoint","this","exists","data","id","language","alt","className","draggable","loading","src","basename","icon","oninit","vnode","languages","app","all","options","reduce","lang","flag","attrs","extra","view","uppercase","toUpperCase","Component","LanguageDiscussionModal","current","selected","discussion","title","trans","content","map","onclick","select","bind","hideSubmitButton","Button","type","disabled","onsubmit","m","redraw","e","preventDefault","hide","save","relationships","then","DiscussionPage","stream","update","loaded","Modal","sort","b","toLowerCase","LanguageDropdown","defaultValue","attribute","formatter","locale","buttonClassName","keys","langId","isItemSelected","active","addLanguage","items","isPrivateDiscussion","add","components","utils","models","extensions","Tag","localisedLastDiscussion","Forum","discussionLanguages","Discussion","canChangeLanguage","extend","DiscussionControls","show","IndexPage","promise","dislang","params","composer","fields","getBy","localeComposer","DiscussionComposer","chooseLanguage","callback","$","focus","_isByobuComposer","component","override","original","DiscussionListItem","DiscussionHero","DiscussionListState","routeName","include","filter","q","subscription","paramLang","showAnyOpt","GlobalSearchState","route","param","defaultSelected","any","default","setRouteWithForcedRefresh","lastPostedDiscussion","desiredLanguageCode","user","preferences","desiredLanguageId","find","attributes","slug","lastPostedAt","Date","at","toISOString"],"sourceRoot":""}