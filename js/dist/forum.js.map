{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/discussion-language/./node_modules/twemoji-basename/index.js","webpack://@fof/discussion-language/webpack/bootstrap","webpack://@fof/discussion-language/webpack/runtime/compat get default export","webpack://@fof/discussion-language/webpack/runtime/define property getters","webpack://@fof/discussion-language/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/discussion-language/webpack/runtime/make namespace object","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/models/Forum']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['tags/common/models/Tag']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@fof/discussion-language/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/discussion-language/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/discussion-language/./src/common/models/Language.js","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@fof/discussion-language/./src/common/utils/flag.js","webpack://@fof/discussion-language/./src/forum/components/Language.js","webpack://@fof/discussion-language/./src/forum/components/LanguageDiscussionModal.js","webpack://@fof/discussion-language/./src/forum/addEditLanguageModal.js","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@fof/discussion-language/./src/forum/addLanguageComposer.js","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/states/GlobalSearchState']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/utils/setRouteWithForcedRefresh']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/components/SelectDropdown']\"","webpack://@fof/discussion-language/./src/forum/components/LanguageDropdown.js","webpack://@fof/discussion-language/./src/forum/addLanguageToDiscussionList.js","webpack://@fof/discussion-language/./src/forum/components/index.js","webpack://@fof/discussion-language/./src/common/utils/index.js","webpack://@fof/discussion-language/./src/common/models/index.js","webpack://@fof/discussion-language/./src/forum/index.js","webpack://@fof/discussion-language/./src/forum/useLocalisedLastDiscussionOnTagsPage.ts"],"sourcesContent":["/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */\n/* https://github.com/twitter/twemoji/blob/gh-pages/LICENSE */\n\nmodule.exports = function (str) {\n  var r = []\n  var c = 0\n  var p = 0\n  var i = 0\n  var l = str.length\n\n  while (i < l) {\n    c = str.charCodeAt(i++)\n    if (p) {\n      r.push((0x10000 + ((p - 0xD800) << 10) + (c - 0xDC00)).toString(16))\n      p = 0\n    } else if (0xD800 <= c && c <= 0xDBFF) {\n      p = c\n    } else {\n      r.push(c.toString(16))\n    }\n  }\n\n  return r.join('-')\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Forum'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/common/models/Tag'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import Model from 'flarum/common/Model';\n\nexport default class Language extends Model {\n  code = Model.attribute('code');\n  country = Model.attribute('country');\n\n  name = Model.attribute('name');\n  emoji = Model.attribute('emoji');\n\n  apiEndpoint() {\n    return `/fof/discussion-language${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import basename from 'twemoji-basename';\nimport icon from 'flarum/common/helpers/icon';\n\nexport default (language) => {\n  if (!language) return;\n\n  const emoji = language.emoji ? language.emoji() : language;\n\n  return emoji ? (\n    <img\n      alt={(language.country && language.country()) || ''}\n      className=\"emoji\"\n      draggable=\"false\"\n      loading=\"lazy\"\n      src={`//cdn.jsdelivr.net/gh/twitter/twemoji@13/assets/72x72/${basename(emoji)}.png`}\n    />\n  ) : (\n    icon('fas fa-globe')\n  );\n};\n","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\n\nimport flag from '../../common/utils/flag';\n\nexport default class Language extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.languages = app.store.all('discussion-languages');\n    this.options = this.languages.reduce((o, lang) => {\n      o[lang.code()] = (\n        <span>\n          {flag(lang)} {lang.name()}\n        </span>\n      );\n\n      return o;\n    }, this.attrs.extra || {});\n  }\n\n  view() {\n    const { language, uppercase } = this.attrs;\n    const name = language.name() || '';\n\n    return (\n      <span>\n        {flag(language)}\n        &nbsp;\n        {uppercase ? name.toUpperCase() : name}\n      </span>\n    );\n  }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\n\nimport Language from './Language';\n\nexport default class LanguageDiscussionModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.languages = app.store.all('discussion-languages');\n\n    this.current = this.attrs.selected || (this.attrs.discussion && this.attrs.discussion.language());\n    this.selected = this.current;\n  }\n\n  className() {\n    return 'FoFLanguageDiscussionModal';\n  }\n\n  title() {\n    return this.attrs.discussion\n      ? app.translator.trans('fof-discussion-language.forum.change_language.edit_title', { title: <em>{this.attrs.discussion.title()}</em> })\n      : app.translator.trans('fof-discussion-language.forum.change_language.title');\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n        <div className=\"Form-group\">\n          {this.languages.map((language) => (\n            <Button onclick={this.select.bind(this, language)} className={`Button Button--block ${this.selected === language ? 'active' : ''}`}>\n              <Language language={language} uppercase={true} />\n            </Button>\n          ))}\n        </div>\n\n        {!this.attrs.hideSubmitButton && (\n          <div className=\"App-primaryControl\">\n            {Button.component(\n              {\n                type: 'submit',\n                className: 'Button Button--primary',\n                disabled: !this.selected || this.selected === this.current,\n                loading: this.loading,\n                icon: 'fas fa-check',\n              },\n              app.translator.trans('fof-discussion-language.forum.change_language.submit_button')\n            )}\n          </div>\n        )}\n      </div>,\n    ];\n  }\n\n  select(language) {\n    this.selected = language;\n\n    if (this.attrs.hideSubmitButton) return this.onsubmit();\n\n    m.redraw();\n  }\n\n  onsubmit(e) {\n    if (e) e.preventDefault();\n\n    const { discussion, onsubmit } = this.attrs;\n\n    this.loading = true;\n\n    if (!discussion) {\n      this.hide();\n\n      if (onsubmit) onsubmit(this.selected);\n\n      return;\n    }\n\n    const language = this.selected;\n\n    discussion\n      .save({ relationships: { language } })\n      .then(() => {\n        if (app.current instanceof DiscussionPage) {\n          app.current.stream.update();\n        }\n\n        return this.hide();\n      })\n      .catch(this.loaded.bind(this));\n  }\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport Button from 'flarum/common/components/Button';\n\nimport LanguageDiscussionModal from './components/LanguageDiscussionModal';\n\nexport default () => {\n  extend(DiscussionControls, 'moderationControls', function (items, discussion) {\n    if (discussion.canChangeLanguage()) {\n      items.add(\n        'language',\n        Button.component(\n          {\n            icon: 'fas fa-globe',\n            onclick: () => app.modal.show(LanguageDiscussionModal, { discussion }),\n          },\n          app.translator.trans('fof-discussion-language.forum.discussion_controls.change_language_button')\n        )\n      );\n    }\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","import { extend, override } from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\n\nimport LanguageDiscussionModal from './components/LanguageDiscussionModal';\nimport Language from './components/Language';\n\nconst sort = (a, b) => a.code().toLowerCase() > b.code().toLowerCase();\n\nexport default () => {\n  extend(IndexPage.prototype, 'newDiscussionAction', function (promise) {\n    const dislang = app.search.params().language;\n\n    if (dislang) {\n      promise.then((composer) => (composer.fields.language = app.store.getBy('discussion-languages', 'code', dislang)));\n    } else {\n      const localeComposer = app.forum.attribute('fof-discussion-language.composerLocaleDefault');\n      app.composer.fields.language = localeComposer ? app.store.getBy('discussion-languages', 'code', app.translator.formatter.locale) : '';\n    }\n  });\n\n  DiscussionComposer.prototype.chooseLanguage = function (hide, callback) {\n    app.modal.show(LanguageDiscussionModal, {\n      selected: this.composer.fields.language,\n      hideSubmitButton: hide,\n      onsubmit: (language) => {\n        this.composer.fields.language = language;\n        this.$('textarea').focus();\n\n        if (callback) callback();\n      },\n    });\n  };\n\n  extend(DiscussionComposer.prototype, 'headerItems', function (items) {\n    // Don't add lang item to byobu composers\n    if (this._isByobuComposer) return;\n\n    items.add(\n      'language',\n      <a className=\"DiscussionComposer-changeTags\" onclick={this.chooseLanguage.bind(this, true, null)}>\n        <span className={`LanguageLabel ${this.composer.fields.language ? '' : 'none'}`}>\n          {this.composer.fields.language\n            ? Language.component({ language: this.composer.fields.language, uppercase: true })\n            : app.translator.trans('fof-discussion-language.forum.composer_discussion.choose_language_link')}\n        </span>\n      </a>,\n      20\n    );\n  });\n\n  override(DiscussionComposer.prototype, 'onsubmit', function (original) {\n    // Don't add lang stuff to byobu composers\n    if (this._isByobuComposer) return original();\n\n    if (!this.composer.fields.language) return this.chooseLanguage(true, original);\n\n    original();\n  });\n\n  extend(DiscussionComposer.prototype, 'data', function (data) {\n    // Don't add lang stuff to byobu composers\n    if (this._isByobuComposer) return;\n\n    data.relationships = data.relationships || {};\n\n    data.relationships.language = this.composer.fields.language || app.store.all('discussion-languages').sort(sort)[0];\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionHero'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionListItem'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/GlobalSearchState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/setRouteWithForcedRefresh'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/SelectDropdown'];","import app from 'flarum/forum/app';\n\nimport Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\n\nimport Language from './Language';\nimport SelectDropdown from 'flarum/common/components/SelectDropdown';\n\nexport default class LanguageDropdown extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.languages = app.store.all('discussion-languages');\n    /**\n     * @type {Record<string, import('mithril').Component>}\n     */\n    this.options = this.languages.reduce((o, lang) => {\n      o[lang.code()] = <Language language={lang} />;\n\n      return o;\n    }, this.attrs.extra || {});\n  }\n\n  view() {\n    const defaultValue = app.forum.attribute('fof-discussion-language.showAnyLangOpt') ? 'any' : app.translator.formatter.locale;\n\n    return (\n      <SelectDropdown buttonClassName=\"Button\">\n        {Object.keys(this.options).map((langId) => {\n          const isItemSelected = this.attrs.selected ? langId === this.attrs.selected : langId === defaultValue;\n\n          return (\n            <Button active={isItemSelected} icon={isItemSelected ? 'fas fa-check' : true} onclick={this.attrs.onclick?.bind?.(this, langId)}>\n              {this.options[langId]}\n            </Button>\n          );\n        })}\n      </SelectDropdown>\n    );\n  }\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\nimport GlobalSearchState from 'flarum/forum/states/GlobalSearchState';\nimport setRouteWithForcedRefresh from 'flarum/common/utils/setRouteWithForcedRefresh';\n\nimport flag from '../common/utils/flag';\nimport LanguageDropdown from './components/LanguageDropdown';\n\nconst addLanguage = function (items) {\n  // Ignore PDs from Byobu\n  // Must be conditional call in case byobu not installed\n  if (this.attrs.discussion.isPrivateDiscussion?.()) return;\n\n  const language = this.attrs.discussion.language();\n\n  if (!language) return;\n\n  items.add(\n    'discussion-language',\n    <span>\n      {flag(language) || <i className=\"fas fa-globe\" />}\n      <code>{language.name()}</code>\n    </span>,\n    5\n  );\n};\n\nexport default () => {\n  extend(DiscussionListItem.prototype, 'infoItems', addLanguage);\n  extend(DiscussionHero.prototype, 'items', addLanguage);\n\n  extend(DiscussionListState.prototype, 'requestParams', function (params) {\n    const routeName = app.current.data.routeName;\n\n    if (routeName === 'byobuPrivate') return;\n\n    params.include.push('language');\n\n    // Do not filter user discussions page as there is no dropdown\n    if (routeName === 'user.discussions') return;\n\n    // Required until https://github.com/flarum/framework/pull/3376 is released.\n    if (routeName === 'following' && params.filter.q) {\n      params.filter.q += ` is:${params.filter.subscription || 'following'}`;\n      delete params.filter.subscription;\n    }\n\n    const paramLang = app.search.params().language;\n    const locale = app.search.params().language ?? app.translator.formatter.locale;\n    const showAnyOpt = app.forum.attribute('fof-discussion-language.showAnyLangOpt');\n\n    if (params.filter.q) {\n      if (showAnyOpt) {\n        if (paramLang) {\n          params.filter.q += ' language:' + paramLang;\n        }\n      } else {\n        params.filter.q += ' language:' + locale;\n      }\n    } else {\n      if (!showAnyOpt || paramLang) {\n        params.filter.language = locale;\n      }\n    }\n  });\n\n  extend(GlobalSearchState.prototype, 'stickyParams', (params) => (params.language = m.route.param('language')));\n\n  extend(IndexPage.prototype, 'viewItems', function (items) {\n    // Don't add language controls to /private (fof/byobu)\n    if (app.current.data.routeName === 'byobuPrivate') return;\n\n    let extra, defaultSelected;\n    if (app.forum.attribute('fof-discussion-language.showAnyLangOpt')) {\n      extra = { any: app.translator.trans('fof-discussion-language.forum.index_language.any') };\n      defaultSelected = 'any';\n    } else {\n      defaultSelected = app.translator.formatter.locale;\n    }\n\n    items.add(\n      'language',\n      LanguageDropdown.component({\n        extra,\n        default: defaultSelected,\n        onclick: (key) => {\n          const params = app.search.params();\n\n          if (key === defaultSelected) delete params.language;\n          else params.language = key;\n\n          setRouteWithForcedRefresh(app.route(app.current.get('routeName'), params));\n        },\n        selected: app.search.params().language,\n      })\n    );\n  });\n};\n","import Language from './Language';\nimport LanguageDiscussionModal from './LanguageDiscussionModal';\nimport LanguageDropdown from './LanguageDropdown';\n\nexport const components = {\n  Language,\n  LanguageDiscussionModal,\n  LanguageDropdown,\n};\n","import flag from './flag';\n\nexport const utils = {\n  flag,\n};\n","import Language from './Language';\n\nexport const models = {\n  Language,\n};\n","import app from 'flarum/forum/app';\nimport Model from 'flarum/common/Model';\nimport Forum from 'flarum/common/models/Forum';\nimport Tag from 'flarum/tags/common/models/Tag';\nimport Discussion from 'flarum/common/models/Discussion';\n\nimport Language from '../common/models/Language';\n\nimport addEditLanguageModal from './addEditLanguageModal';\nimport addLanguageComposer from './addLanguageComposer';\nimport addLanguageToDiscussionList from './addLanguageToDiscussionList';\nimport useLocalisedLastDiscussionOnTagsPage from './useLocalisedLastDiscussionOnTagsPage';\n\nexport * from './components';\nexport * from '../common/utils';\nexport * from '../common/models';\n\napp.initializers.add('fof/discussion-language', () => {\n  app.store.models['discussion-languages'] = Language;\n\n  if ('flarum-tags' in flarum.extensions) Tag.prototype.localisedLastDiscussion = Model.attribute('localisedLastDiscussion');\n\n  Forum.prototype.discussionLanguages = Model.hasMany('discussionLanguages');\n  Discussion.prototype.language = Model.hasOne('language');\n  Discussion.prototype.canChangeLanguage = Model.attribute('canChangeLanguage');\n\n  addEditLanguageModal();\n  addLanguageComposer();\n  addLanguageToDiscussionList();\n  useLocalisedLastDiscussionOnTagsPage();\n});\n","import app from 'flarum/forum/app';\n\nimport Tag from 'flarum/tags/common/models/Tag';\n\nimport Discussion from 'flarum/common/models/Discussion';\nimport Model from 'flarum/common/Model';\n\nexport default function useLocalisedLastDiscussionOnTagsPage() {\n  if (!('flarum-tags' in flarum.extensions)) return;\n\n  Tag.prototype.lastPostedDiscussion = function (this: Tag) {\n    const original = Model.hasOne('lastPostedDiscussion').bind(this);\n\n    if (!app.forum.attribute('fof-discussion-language.useLocaleForTagsPageLastDiscussion')) {\n      return original();\n    }\n\n    const data = this.localisedLastDiscussion();\n\n    /**\n     * Priorities:\n     *\n     * 1. User's selected forum locale\n     * 2. Detected locale\n     * 3. First disucssion language available\n     */\n    const desiredLanguageCode =\n      app.session.user?.preferences?.()?.locale || (app.translator as any).formatter.locale || (app.forum as any).discussionLanguages()[0].code();\n\n    const desiredLanguageId = (app.forum as any)\n      .discussionLanguages()\n      .find((lang: any) => lang.code() === desiredLanguageCode)\n      ?.id();\n\n    // If forum locale not available as a discussion lang, default to any language\n    if (!desiredLanguageId) {\n      return original();\n    }\n\n    const discussion = data[desiredLanguageId];\n\n    // fall back to original attribute\n    if (!discussion) return original();\n\n    return new Discussion({\n      attributes: {\n        title: discussion.title,\n        slug: discussion.id, // navigating using only ID works fine\n        lastPostedAt: new Date(discussion.at * 1000).toISOString(),\n      },\n    });\n  };\n}\n"],"names":["module","exports","str","r","c","p","i","l","length","charCodeAt","push","toString","join","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","create","constructor","Language","code","Model","country","name","emoji","apiEndpoint","this","exists","data","id","language","alt","className","draggable","loading","src","basename","icon","oninit","vnode","languages","app","options","reduce","lang","flag","attrs","extra","view","uppercase","toUpperCase","Component","LanguageDiscussionModal","current","selected","discussion","title","content","map","onclick","select","bind","hideSubmitButton","Button","type","disabled","onsubmit","m","redraw","e","preventDefault","hide","save","relationships","then","DiscussionPage","loaded","Modal","sort","b","toLowerCase","LanguageDropdown","defaultValue","buttonClassName","keys","langId","isItemSelected","active","addLanguage","items","isPrivateDiscussion","add","components","utils","models","extensions","Tag","Forum","Discussion","extend","DiscussionControls","canChangeLanguage","IndexPage","promise","dislang","composer","fields","localeComposer","DiscussionComposer","callback","$","focus","_isByobuComposer","chooseLanguage","override","original","DiscussionListItem","DiscussionHero","DiscussionListState","params","routeName","include","filter","q","subscription","paramLang","locale","showAnyOpt","GlobalSearchState","route","param","defaultSelected","any","component","default","setRouteWithForcedRefresh","localisedLastDiscussion","desiredLanguageCode","preferences","desiredLanguageId","find","attributes","slug","lastPostedAt","Date","at","toISOString"],"sourceRoot":""}