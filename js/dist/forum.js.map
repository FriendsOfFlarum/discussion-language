{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@fof/discussion-language/./node_modules/twemoji-basename/index.js","webpack://@fof/discussion-language/webpack/bootstrap","webpack://@fof/discussion-language/webpack/runtime/compat get default export","webpack://@fof/discussion-language/webpack/runtime/define property getters","webpack://@fof/discussion-language/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/discussion-language/webpack/runtime/make namespace object","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/app']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/extend']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/discussion-language/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/discussion-language/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@fof/discussion-language/./src/common/utils/flag.js","webpack://@fof/discussion-language/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/discussion-language/./src/forum/utils/generateLanguageOptions.tsx","webpack://@fof/discussion-language/./src/forum/components/LanguageDisplay.tsx","webpack://@fof/discussion-language/./src/forum/components/LanguageDiscussionModal.js","webpack://@fof/discussion-language/./src/forum/addEditLanguageModal.js","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@fof/discussion-language/./src/forum/addLanguageComposer.js","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['forum/states/GlobalSearchState']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/utils/setRouteWithForcedRefresh']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/components/Dropdown']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@fof/discussion-language/./src/forum/components/LanguageDropdown.tsx","webpack://@fof/discussion-language/./src/forum/addLanguageToDiscussionList.js","webpack://@fof/discussion-language/external root \"flarum.core.compat['tags/common/models/Tag']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/discussion-language/external assign \"flarum.extensions['fof-follow-tags']\"","webpack://@fof/discussion-language/./src/forum/components/index.js","webpack://@fof/discussion-language/./src/common/utils/index.js","webpack://@fof/discussion-language/./src/common/models/Language.ts","webpack://@fof/discussion-language/./src/common/models/index.ts","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/extenders']\"","webpack://@fof/discussion-language/external root \"flarum.core.compat['common/models/Forum']\"","webpack://@fof/discussion-language/./src/common/extend.ts","webpack://@fof/discussion-language/./src/forum/extend.ts","webpack://@fof/discussion-language/./src/forum/index.ts","webpack://@fof/discussion-language/./src/forum/useLocalisedLastDiscussionOnTagsPage.ts","webpack://@fof/discussion-language/./src/forum/extendSubscriptionModal.js"],"sourcesContent":["/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */\n/* https://github.com/twitter/twemoji/blob/gh-pages/LICENSE */\n\nmodule.exports = function (str) {\n  var r = []\n  var c = 0\n  var p = 0\n  var i = 0\n  var l = str.length\n\n  while (i < l) {\n    c = str.charCodeAt(i++)\n    if (p) {\n      r.push((0x10000 + ((p - 0xD800) << 10) + (c - 0xDC00)).toString(16))\n      p = 0\n    } else if (0xD800 <= c && c <= 0xDBFF) {\n      p = c\n    } else {\n      r.push(c.toString(16))\n    }\n  }\n\n  return r.join('-')\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import basename from 'twemoji-basename';\nimport icon from 'flarum/common/helpers/icon';\n\nexport default (language) => {\n  if (!language) return;\n\n  const emoji = language.emoji ? language.emoji() : language;\n\n  return emoji ? (\n    <img\n      alt={(language.country && language.country()) || ''}\n      className=\"emoji\"\n      draggable=\"false\"\n      loading=\"lazy\"\n      src={`//cdn.jsdelivr.net/gh/twitter/twemoji@14/assets/72x72/${basename(emoji)}.png`}\n    />\n  ) : (\n    icon('fas fa-globe')\n  );\n};\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","import Language from '../../common/models/Language';\nimport LanguageDisplay from '../components/LanguageDisplay';\nimport app from 'flarum/forum/app';\nimport type Mithril from 'mithril';\n\nexport default function generateLanguageOptions(extraOptions?: Record<string, Mithril.Children>): Record<string, Mithril.Children> {\n  const options: Record<string, Mithril.Children> = {};\n  const languages = app.store.all<Language>('discussion-languages');\n\n  // Populate the options with the languages\n  languages.forEach((lang) => {\n    options[lang.code()] = <LanguageDisplay language={lang} />;\n  });\n\n  // Merge extra options, if provided\n  return { ...options, ...extraOptions };\n}\n","import app from 'flarum/forum/app';\nimport Component from 'flarum/common/Component';\nimport flag from '../../common/utils/flag';\nimport Language from '../../common/models/Language';\nimport type Mithril from 'mithril';\nimport generateLanguageOptions from '../utils/generateLanguageOptions';\n\ninterface LanguageDisplayAttrs {\n  language: Language;\n  uppercase?: boolean;\n  extra?: Record<string, Mithril.Children>;\n}\n\nexport default class LanguageDisplay extends Component<LanguageDisplayAttrs> {\n  options!: Record<string, Mithril.Children>;\n\n  oninit(vnode: Mithril.Vnode<LanguageDisplayAttrs, this>): void {\n    super.oninit(vnode);\n\n    this.options = generateLanguageOptions(this.attrs.extra);\n  }\n\n  view(): Mithril.Child {\n    const { language, uppercase } = this.attrs;\n    const name = language.name() || '';\n\n    return (\n      <span>\n        {flag(language)} {uppercase ? name.toUpperCase() : name}\n      </span>\n    );\n  }\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\n\nimport LanguageDisplay from './LanguageDisplay';\n\nexport default class LanguageDiscussionModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.languages = app.store.all('discussion-languages').filter((language) => language.code() !== 'any');\n\n    this.current = this.attrs.selected || (this.attrs.discussion && this.attrs.discussion.language());\n    this.selected = this.current;\n  }\n\n  className() {\n    return 'FoFLanguageDiscussionModal';\n  }\n\n  title() {\n    return this.attrs.discussion\n      ? app.translator.trans('fof-discussion-language.forum.change_language.edit_title', { title: <em>{this.attrs.discussion.title()}</em> })\n      : app.translator.trans('fof-discussion-language.forum.change_language.title');\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n        <div className=\"Form-group\">\n          {this.languages.map((language) => (\n            <Button onclick={this.select.bind(this, language)} className={`Button Button--block ${this.selected === language ? 'active' : ''}`}>\n              <LanguageDisplay language={language} uppercase={true} />\n            </Button>\n          ))}\n        </div>\n\n        {!this.attrs.hideSubmitButton && (\n          <div className=\"App-primaryControl\">\n            {Button.component(\n              {\n                type: 'submit',\n                className: 'Button Button--primary',\n                disabled: !this.selected || this.selected === this.current,\n                loading: this.loading,\n                icon: 'fas fa-check',\n              },\n              app.translator.trans('fof-discussion-language.forum.change_language.submit_button')\n            )}\n          </div>\n        )}\n      </div>,\n    ];\n  }\n\n  select(language) {\n    this.selected = language;\n\n    if (this.attrs.hideSubmitButton) return this.onsubmit();\n\n    m.redraw();\n  }\n\n  onsubmit(e) {\n    if (e) e.preventDefault();\n\n    const { discussion, onsubmit } = this.attrs;\n\n    this.loading = true;\n\n    if (!discussion) {\n      this.hide();\n\n      if (onsubmit) onsubmit(this.selected);\n\n      return;\n    }\n\n    const language = this.selected;\n\n    discussion\n      .save({ relationships: { language } })\n      .then(() => {\n        if (app.current instanceof DiscussionPage) {\n          app.current.stream.update();\n        }\n\n        return this.hide();\n      })\n      .catch(this.loaded.bind(this));\n  }\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport Button from 'flarum/common/components/Button';\n\nimport LanguageDiscussionModal from './components/LanguageDiscussionModal';\n\nexport default () => {\n  extend(DiscussionControls, 'moderationControls', function (items, discussion) {\n    if (discussion.canChangeLanguage()) {\n      items.add(\n        'language',\n        Button.component(\n          {\n            icon: 'fas fa-globe',\n            onclick: () => app.modal.show(LanguageDiscussionModal, { discussion }),\n          },\n          app.translator.trans('fof-discussion-language.forum.discussion_controls.change_language_button')\n        )\n      );\n    }\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","import { extend, override } from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\n\nimport LanguageDiscussionModal from './components/LanguageDiscussionModal';\nimport LanguageDisplay from './components/LanguageDisplay';\n\nconst sort = (a, b) => a.code().toLowerCase() > b.code().toLowerCase();\n\nexport default () => {\n  extend(IndexPage.prototype, 'newDiscussionAction', function (promise) {\n    const dislang = app.search.params().language;\n\n    if (dislang) {\n      promise.then((composer) => (composer.fields.language = app.store.getBy('discussion-languages', 'code', dislang)));\n    } else {\n      const localeComposer = app.forum.attribute('fof-discussion-language.composerLocaleDefault');\n      app.composer.fields.language = localeComposer ? app.store.getBy('discussion-languages', 'code', app.translator.getLocale()) : '';\n    }\n  });\n\n  DiscussionComposer.prototype.chooseLanguage = function (hide, callback) {\n    app.modal.show(LanguageDiscussionModal, {\n      selected: this.composer.fields.language,\n      hideSubmitButton: hide,\n      onsubmit: (language) => {\n        this.composer.fields.language = language;\n        this.$('textarea').focus();\n\n        if (callback) callback();\n      },\n    });\n  };\n\n  extend(DiscussionComposer.prototype, 'headerItems', function (items) {\n    // Don't add lang item to byobu composers\n    if (this._isByobuComposer) return;\n\n    items.add(\n      'language',\n      <a className=\"DiscussionComposer-changeTags\" onclick={this.chooseLanguage.bind(this, true, null)}>\n        <span className={`LanguageLabel ${this.composer.fields.language ? '' : 'none'}`}>\n          {this.composer.fields.language\n            ? LanguageDisplay.component({ language: this.composer.fields.language, uppercase: true })\n            : app.translator.trans('fof-discussion-language.forum.composer_discussion.choose_language_link')}\n        </span>\n      </a>,\n      20\n    );\n  });\n\n  override(DiscussionComposer.prototype, 'onsubmit', function (original) {\n    // Don't add lang stuff to byobu composers\n    if (this._isByobuComposer) return original();\n\n    if (!this.composer.fields.language) return this.chooseLanguage(true, original);\n\n    original();\n  });\n\n  extend(DiscussionComposer.prototype, 'data', function (data) {\n    // Don't add lang stuff to byobu composers\n    if (this._isByobuComposer) return;\n\n    data.relationships = data.relationships || {};\n\n    data.relationships.language = this.composer.fields.language || app.store.all('discussion-languages').sort(sort)[0];\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionHero'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionListItem'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/GlobalSearchState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/setRouteWithForcedRefresh'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Dropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","import app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\nimport Dropdown, { IDropdownAttrs } from 'flarum/common/components/Dropdown';\nimport type Mithril from 'mithril';\nimport icon from 'flarum/common/helpers/icon';\nimport classList from 'flarum/common/utils/classList';\nimport generateLanguageOptions from '../utils/generateLanguageOptions';\nimport Stream from 'flarum/common/utils/Stream';\n\nexport interface LanguageDropdownAttrs extends IDropdownAttrs {\n  className?: string;\n  selected?: string;\n  onclick?: (langId: string) => void;\n  extra?: Record<string, Mithril.Children>;\n}\n\nexport default class LanguageDropdown extends Dropdown<LanguageDropdownAttrs> {\n  selected!: Stream<string>;\n  options!: Record<string, Mithril.Children>;\n  loaded: boolean = false;\n\n  static initAttrs(attrs: LanguageDropdownAttrs): void {\n    attrs.buttonClassName = 'Button';\n    attrs.className = classList(attrs.className, 'Dropdown--select', 'Dropdown--language');\n    super.initAttrs(attrs);\n  }\n\n  oninit(vnode: Mithril.Vnode<LanguageDropdownAttrs, this>): void {\n    super.oninit(vnode);\n\n    this.loadLanguages();\n    this.selected = Stream(this.initSelectedLanguage());\n  }\n\n  getDefaultLanguage(): string {\n    return (app.forum.attribute('fof-discussion-language.showAnyLangOpt') ? 'any' : app.translator.getLocale()) || '';\n  }\n\n  initSelectedLanguage(): string {\n    return this.attrs.selected || this.getDefaultLanguage();\n  }\n\n  loadLanguages(): void {\n    if (this.loaded === false) {\n      this.options = generateLanguageOptions(this.attrs.extra);\n      this.loaded = true;\n    }\n  }\n\n  buildDropdownContent(): Mithril.ChildArray {\n    return Object.keys(this.options).map((langId) => {\n      const isItemSelected = this.selected() === langId;\n\n      return (\n        <Button\n          key={langId + isItemSelected}\n          active={isItemSelected}\n          icon={isItemSelected ? 'fas fa-check' : true}\n          onclick={() => {\n            this.selected(langId);\n\n            if (this.attrs.onclick) {\n              this.attrs.onclick.call(this, langId);\n            }\n          }}\n          aria-label={langId}\n        >\n          {this.options[langId]}\n        </Button>\n      );\n    });\n  }\n\n  view(vnode: Mithril.Vnode<LanguageDropdownAttrs, this>) {\n    const children = this.buildDropdownContent();\n\n    return super.view({ ...vnode.attrs, children });\n  }\n\n  getButton(children: Mithril.ChildArray): Mithril.Vnode<any, any> {\n    return (\n      <button\n        key={this.selected() + 'Button'}\n        className={'Dropdown-toggle ' + this.attrs.buttonClassName}\n        aria-haspopup=\"menu\"\n        aria-label={this.attrs.accessibleToggleLabel}\n        data-toggle=\"dropdown\"\n        onclick={this.attrs.onclick}\n      >\n        {this.getButtonContent(children)}\n      </button>\n    );\n  }\n\n  getButtonContent(children: Mithril.ChildArray): Mithril.ChildArray {\n    return [\n      <span className=\"Button-label\">{this.options[this.selected()]}</span>,\n      this.attrs.caretIcon ? icon(this.attrs.caretIcon, { className: 'Button-caret' }) : null,\n    ];\n  }\n\n  getMenu(items: Mithril.Vnode<any, any>[]): Mithril.Vnode<any, any> {\n    return (\n      <ul key={this.selected() + 'Menu'} className={'Dropdown-menu dropdown-menu ' + this.attrs.menuClassName}>\n        {items}\n      </ul>\n    );\n  }\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\nimport GlobalSearchState from 'flarum/forum/states/GlobalSearchState';\nimport setRouteWithForcedRefresh from 'flarum/common/utils/setRouteWithForcedRefresh';\n\nimport flag from '../common/utils/flag';\nimport LanguageDropdown from './components/LanguageDropdown';\n\nconst addLanguage = function (items) {\n  // Ignore PDs from Byobu\n  // Must be conditional call in case byobu not installed\n  if (this.attrs.discussion.isPrivateDiscussion?.()) return;\n\n  const language = this.attrs.discussion.language();\n\n  if (!language) return;\n\n  items.add(\n    'discussion-language',\n    <span>\n      {flag(language) || <i className=\"fas fa-globe\" />}\n      <code>{language.name()}</code>\n    </span>,\n    5\n  );\n};\n\nexport default () => {\n  extend(DiscussionListItem.prototype, 'infoItems', addLanguage);\n  extend(DiscussionHero.prototype, 'items', addLanguage);\n\n  extend(DiscussionListState.prototype, 'requestParams', function (params) {\n    const routeName = app.current.data.routeName;\n\n    if (routeName === 'byobuPrivate') return;\n    if (routeName === 'byobuUserPrivate') return;\n\n    params.include.push('language');\n\n    // Do not filter user discussions page as there is no dropdown\n    if (routeName === 'user.discussions') return;\n\n    // Required until https://github.com/flarum/framework/pull/3376 is released.\n    if (routeName === 'following' && params.filter.q) {\n      params.filter.q += ` is:${params.filter.subscription || 'following'}`;\n      delete params.filter.subscription;\n    }\n\n    const paramLang = app.search.params().language;\n    const locale = app.search.params().language ?? app.translator.getLocale();\n    const showAnyOpt = app.forum.attribute('fof-discussion-language.showAnyLangOpt');\n\n    if (params.filter.q) {\n      if (showAnyOpt) {\n        if (paramLang) {\n          params.filter.q += ' language:' + paramLang;\n        }\n      } else {\n        params.filter.q += ' language:' + locale;\n      }\n    } else {\n      if (!showAnyOpt || paramLang) {\n        params.filter.language = locale;\n      }\n    }\n  });\n\n  extend(GlobalSearchState.prototype, 'stickyParams', (params) => (params.language = m.route.param('language')));\n\n  extend(IndexPage.prototype, 'viewItems', function (items) {\n    // Don't add language controls to /private (fof/byobu)\n    if (app.current.data.routeName === 'byobuPrivate') return;\n\n    const defaultSelected = app.forum.attribute('fof-discussion-language.showAnyLangOpt') ? 'any' : app.translator.getLocale();\n\n    items.add(\n      'language',\n      <LanguageDropdown\n        selected={app.search.params().language}\n        onclick={(key) => {\n          // if `key` is not a string, return early\n          if (typeof key !== 'string') return;\n\n          const params = app.search.params();\n\n          if (key === defaultSelected) delete params.language;\n          else params.language = key;\n\n          setRouteWithForcedRefresh(app.route(app.current.get('routeName'), params));\n        }}\n      />\n    );\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/common/models/Tag'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.extensions['fof-follow-tags'];","import LanguageDisplay from './LanguageDisplay';\nimport LanguageDiscussionModal from './LanguageDiscussionModal';\nimport LanguageDropdown from './LanguageDropdown';\n\nexport const components = {\n  LanguageDisplay,\n  LanguageDiscussionModal,\n  LanguageDropdown,\n};\n","import flag from './flag';\n\nexport const utils = {\n  flag,\n};\n","import Model from 'flarum/common/Model';\n\nexport default class Language extends Model {\n  id() {\n    return Model.attribute<string>('id').call(this);\n  }\n\n  code() {\n    return Model.attribute<string>('code').call(this);\n  }\n\n  country() {\n    return Model.attribute<string>('country').call(this);\n  }\n\n  name() {\n    return Model.attribute<string>('name').call(this);\n  }\n\n  emoji() {\n    return Model.attribute<string>('emoji').call(this);\n  }\n\n  apiEndpoint() {\n    return `/fof/discussion-language${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Language from './Language';\n\nexport const models = {\n  Language,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Forum'];","import Extend from 'flarum/common/extenders';\nimport Language from '../common/models/Language';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Forum from 'flarum/common/models/Forum';\nimport Tag from 'flarum/tags/common/models/Tag';\n\nexport default [\n  new Extend.Store() //\n    .add('discussion-languages', Language),\n\n  new Extend.Model(Discussion) //\n    .hasOne('language')\n    .attribute<boolean>('canChangeLanguage'),\n\n  new Extend.Model(Forum) //\n    .hasMany<Language>('discussionLanguages'),\n\n  new Extend.Model(Tag) //\n    .attribute<string>('subscriptionLanguage')\n    .attribute<string>('localisedLastDiscussion'),\n];\n","import commonExtend from '../common/extend';\n\nexport default [...commonExtend];\n","import app from 'flarum/forum/app';\nimport addEditLanguageModal from './addEditLanguageModal';\nimport addLanguageComposer from './addLanguageComposer';\nimport addLanguageToDiscussionList from './addLanguageToDiscussionList';\nimport useLocalisedLastDiscussionOnTagsPage from './useLocalisedLastDiscussionOnTagsPage';\nimport extendSubscriptionModal from './extendSubscriptionModal';\n\nexport * from './components';\nexport * from '../common/utils';\nexport * from '../common/models';\nexport { default as extend } from './extend';\n\napp.initializers.add('fof/discussion-language', () => {\n  addEditLanguageModal();\n  addLanguageComposer();\n  addLanguageToDiscussionList();\n  useLocalisedLastDiscussionOnTagsPage();\n  extendSubscriptionModal();\n});\n","import app from 'flarum/forum/app';\n\nimport Tag from 'flarum/tags/common/models/Tag';\n\nimport Discussion from 'flarum/common/models/Discussion';\nimport Model from 'flarum/common/Model';\n\nexport default function useLocalisedLastDiscussionOnTagsPage() {\n  if (!('flarum-tags' in flarum.extensions)) return;\n\n  Tag.prototype.lastPostedDiscussion = function (this: Tag) {\n    const original = Model.hasOne('lastPostedDiscussion').bind(this);\n\n    if (!app.forum.attribute('fof-discussion-language.useLocaleForTagsPageLastDiscussion')) {\n      return original();\n    }\n\n    const data = this.localisedLastDiscussion();\n\n    /**\n     * Priorities:\n     *\n     * 1. User's selected forum locale\n     * 2. Detected locale\n     * 3. First disucssion language available\n     */\n    const desiredLanguageCode =\n      app.session.user?.preferences?.()?.locale || (app.translator as any).formatter.locale || (app.forum as any).discussionLanguages()[0].code();\n\n    const desiredLanguageId = (app.forum as any)\n      .discussionLanguages()\n      .find((lang: any) => lang.code() === desiredLanguageCode)\n      ?.id();\n\n    // If forum locale not available as a discussion lang, default to any language\n    if (!desiredLanguageId) {\n      return original();\n    }\n\n    const discussion = data[desiredLanguageId];\n\n    // fall back to original attribute\n    if (!discussion) return original();\n\n    return new Discussion({\n      attributes: {\n        title: discussion.title,\n        slug: discussion.id, // navigating using only ID works fine\n        lastPostedAt: new Date(discussion.at * 1000).toISOString(),\n      },\n    });\n  };\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport { components } from '@fof-follow-tags';\nimport LanguageDropdown from './components/LanguageDropdown';\nimport Stream from 'flarum/common/utils/Stream';\n\nconst SUBSCRIPTION_LANGUAGE_PRIORITY = 80;\n\nexport default function extendSubscriptionModal() {\n  if (!('fof-follow-tags' in flarum.extensions)) return;\n\n  extend(components.SubscriptionModal.prototype, 'oninit', function () {\n    const tag = this.attrs.model;\n    const subscriptionLanguage = tag.subscriptionLanguage();\n    this.language = Stream(subscriptionLanguage);\n  });\n\n  extend(components.SubscriptionModal.prototype, 'formOptionItems', function (items) {\n    items.add(\n      'subscription_language',\n      <div className=\"Form-group\">\n        <label>{app.translator.trans('fof-discussion-language.forum.sub_controls.subscription_language_label')}</label>\n        <p className=\"helpText\">{app.translator.trans('fof-discussion-language.forum.sub_controls.subscription_language_help')}</p>\n        <LanguageDropdown\n          selected={this.language()}\n          onclick={(key) => {\n            if (typeof key !== 'string') return;\n\n            this.language(key);\n          }}\n        />\n      </div>,\n      SUBSCRIPTION_LANGUAGE_PRIORITY\n    );\n  });\n\n  extend(components.SubscriptionModal.prototype, 'requestData', function (data) {\n    data.language = this.language() || app.translator.getLocale();\n\n    return data;\n  });\n}\n"],"names":["module","exports","str","r","c","p","i","l","length","charCodeAt","push","toString","join","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","create","constructor","language","emoji","m","alt","country","className","draggable","loading","src","basename","icon","_extends","assign","target","arguments","source","apply","this","generateLanguageOptions","extraOptions","options","app","all","forEach","lang","code","LanguageDisplay","_Component","_this","_len","args","Array","_key","concat","_proto","oninit","vnode","attrs","extra","view","_this$attrs","uppercase","name","flag","toUpperCase","Component","LanguageDiscussionModal","_Modal","languages","filter","current","selected","discussion","title","trans","content","map","Button","onclick","select","bind","hideSubmitButton","type","disabled","onsubmit","redraw","e","_this2","preventDefault","hide","save","relationships","then","DiscussionPage","stream","update","loaded","Modal","sort","b","toLowerCase","LanguageDropdown","_Dropdown","initAttrs","buttonClassName","classList","loadLanguages","Stream","initSelectedLanguage","getDefaultLanguage","attribute","getLocale","buildDropdownContent","keys","langId","isItemSelected","active","children","getButton","accessibleToggleLabel","getButtonContent","caretIcon","getMenu","items","menuClassName","Dropdown","addLanguage","_this$attrs$discussio","_this$attrs$discussio2","isPrivateDiscussion","add","extensions","components","utils","Language","_Model","id","Model","apiEndpoint","exists","data","models","Extend","Discussion","hasOne","Forum","hasMany","Tag","commonExtend","extend","DiscussionControls","canChangeLanguage","show","IndexPage","promise","dislang","params","composer","fields","getBy","localeComposer","DiscussionComposer","chooseLanguage","callback","$","focus","_isByobuComposer","component","override","original","DiscussionListItem","DiscussionHero","DiscussionListState","_app$search$params$la","routeName","include","q","subscription","paramLang","locale","showAnyOpt","GlobalSearchState","route","param","defaultSelected","setRouteWithForcedRefresh","lastPostedDiscussion","_app$session$user","_app$session$user$pre","_discussionLanguages$","localisedLastDiscussion","desiredLanguageCode","user","preferences","formatter","discussionLanguages","desiredLanguageId","find","attributes","slug","lastPostedAt","Date","at","toISOString","SubscriptionModal","subscriptionLanguage","model"],"sourceRoot":""}