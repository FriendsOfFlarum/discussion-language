module.exports=function(t){function n(n){for(var e,a,s=n[0],r=n[1],i=0,c=[];i<s.length;i++)a=s[i],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&c.push(o[a][0]),o[a]=0;for(e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);for(u&&u(n);c.length;)c.shift()()}var e={},o={0:0};function a(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.e=function(t){var n=[],e=o[t];if(0!==e)if(e)n.push(e[2]);else{var s=new Promise((function(n,a){e=o[t]=[n,a]}));n.push(e[2]=s);var r,i=document.createElement("script");i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.src=function(t){return a.p+"vendors~"+({1:"countries",3:"iso-639-1"}[t]||t)+".js"}(t);var u=new Error;r=function(n){i.onerror=i.onload=null,clearTimeout(c);var e=o[t];if(0!==e){if(e){var a=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;u.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",u.name="ChunkLoadError",u.type=a,u.request=s,e[1](u)}o[t]=void 0}};var c=setTimeout((function(){r({type:"timeout",target:i})}),12e4);i.onerror=i.onload=r,document.head.appendChild(i)}return Promise.all(n)},a.m=t,a.c=e,a.d=function(t,n,e){a.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,n){if(1&n&&(t=a(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(a.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)a.d(e,o,function(n){return t[n]}.bind(null,o));return e},a.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(n,"a",n),n},a.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},a.p="",a.oe=function(t){throw console.error(t),t};var s=window.webpackJsonpmodule_exports=window.webpackJsonpmodule_exports||[],r=s.push.bind(s);s.push=n,s=s.slice();for(var i=0;i<s.length;i++)n(s[i]);var u=r;return a(a.s=35)}([function(t,n){t.exports=flarum.core.compat["common/Model"]},function(t,n){t.exports=flarum.core.compat["common/extend"]},function(t,n,e){"use strict";function o(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}e.d(n,"a",(function(){return o}))},function(t,n,e){"use strict";var o=e(12),a=e.n(o),s=e(7),r=e.n(s);n.a=function(t){if(t){var n=t.emoji?t.emoji():t;return n?m("img",{alt:t.country&&t.country()||"",className:"emoji",draggable:"false",loading:"lazy",src:"//cdn.jsdelivr.net/gh/twitter/twemoji@13/assets/72x72/"+a()(n)+".png"}):r()("fas fa-globe")}}},function(t,n){t.exports=flarum.core.compat["common/components/Button"]},,function(t,n,e){"use strict";function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}e.d(n,"a",(function(){return u}));var a=e(2);function s(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var r=e(0),i=e.n(r),u=function(t){function n(){for(var n,e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];return s(o(n=t.call.apply(t,[this].concat(a))||this),"code",i.a.attribute("code")),s(o(n),"country",i.a.attribute("country")),s(o(n),"name",i.a.attribute("name")),s(o(n),"emoji",i.a.attribute("emoji")),n}return Object(a.a)(n,t),n.prototype.apiEndpoint=function(){return"/fof/discussion-language"+(this.exists?"/"+this.data.id:"")},n}(i.a)},function(t,n){t.exports=flarum.core.compat["common/helpers/icon"]},function(t,n){t.exports=flarum.core.compat["common/models/Forum"]},function(t,n){t.exports=flarum.core.compat["common/components/Switch"]},function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var o={Language:e(6).a}},function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var o={flag:e(3).a}},function(t,n){
/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */
t.exports=function(t){for(var n=[],e=0,o=0,a=0,s=t.length;a<s;)e=t.charCodeAt(a++),o?(n.push((65536+(o-55296<<10)+(e-56320)).toString(16)),o=0):55296<=e&&e<=56319?o=e:n.push(e.toString(16));return n.join("-")}},,function(t,n){t.exports=flarum.core.compat["common/components/Select"]},,,,function(t,n){t.exports=flarum.core.compat["common/utils/Stream"]},,,,,,,,,,function(t,n){t.exports=flarum.core.compat["admin/components/PermissionGrid"]},function(t,n){t.exports=flarum.core.compat["admin/components/SettingDropdown"]},function(t,n){t.exports=flarum.core.compat["admin/components/ExtensionPage"]},function(t,n){t.exports=flarum.core.compat["common/components/LoadingIndicator"]},function(t,n){t.exports=flarum.core.compat["admin/utils/saveSettings"]},function(t,n){t.exports=flarum.core.compat["admin/app"]},,function(t,n,e){"use strict";e.r(n),e.d(n,"components",(function(){return q})),e.d(n,"utils",(function(){return R})),e.d(n,"models",(function(){return U.a}));var o={};e.r(o),e.d(o,"load",(function(){return k})),e.d(o,"default",(function(){return E})),e.d(o,"getEmoji",(function(){return B}));var a,s,r=e(1),i=e(8),u=e.n(i),c=e(28),l=e.n(c),p=e(29),f=e.n(p),d=e(2),g=e(30),h=e.n(g),v=e(4),y=e.n(v),b=e(14),w=e.n(b),_=e(9),L=e.n(_),x=e(31),O=e.n(x),N=e(7),j=e.n(N),S=e(32),F=e.n(S),K=e(18),D=e.n(K),P=e(33),A=e.n(P),C=function(t){var n,e,o,s;return null==(n=a)||null==(e=n[t?"getAllNativeNames":"getAllNames"])||null==(o=e.call(n))||null==(s=o.sort((function(t,n){return t>n})))?void 0:s.reduce((function(t,n){return t[a.getCode(n)]=n,t}),{})},k=function(){return e.p=app.forum.attribute("baseUrl")+"/assets/extensions/fof-discussion-language/",e.e(1).then(e.t.bind(null,36,3)).then((function(t){return s=t.default}))},E=function(t){if(!s)return{};var n=Object.values(s),e=t?"native":"name";return n.map((function(t){return t[e]})).sort((function(t,n){return t>n})).reduce((function(t,o){var a=n.indexOf(n.filter((function(t){return t[e]===o}))[0]);return t[Object.keys(s)[a]]=o,t}),{})},B=function(t){var n,e;return null==(n=s)||null==(e=n[t])?void 0:e.emoji},M=e(3),T=function(t){function n(){return t.apply(this,arguments)||this}Object(d.a)(n,t);var o=n.prototype;return o.oninit=function(n){t.prototype.oninit.call(this,n),this.updating={},this.deleting={},this.codes={},this.countries={},this.newLocale=D()(""),this.newCountry=D()(""),this.nativeKey="fof-discussion-language.native",this.native=app.data.settings[this.nativeKey],this.showFlagsKey="fof-discussion-language.showFlags",this.showFlags=app.data.settings[this.showFlagsKey],this.composerLocaleDefaultKey="fof-discussion-language.composerLocaleDefault",this.composerLocaleDefault=app.data.settings[this.composerLocaleDefaultKey]||0,this.localeSortKey="fof-discussion-language.filter_language_on_http_request",this.localeSort=app.data.settings[this.localeSortKey],this.showAnyLangOptKey="fof-discussion-language.showAnyLangOpt",this.showAnyLangOpt=app.data.settings[this.showAnyLangOptKey],this.loadingData=!0},o.oncreate=function(n){t.prototype.oncreate.call(this,n),this.refresh()},o.refresh=function(){var t=this;return this.loadingData=!0,Promise.all([(e.p=A.a.forum.attribute("baseUrl")+"/assets/extensions/fof-discussion-language/",e.e(3).then(e.bind(null,37)).then((function(t){return a=t.default}))),k()]).then((function(){t.loadingData=!1,m.redraw()}))},o.content=function(){var t=this,n=C(this.native),e=E(this.native);return[m("div",{className:"container"},m("div",{className:"FofDiscussionLanguagesSettingsPage"},m("div",{className:"Form-group"},L.a.component({state:this.native,onchange:function(n){t.native=n,t.refresh(),m.redraw.sync()}},app.translator.trans("fof-discussion-language.admin.settings.native_label"))),m("div",{className:"Form-group"},L.a.component({state:this.showFlags,onchange:function(n){return t.showFlags=n}},app.translator.trans("fof-discussion-language.admin.settings.show_flag_label"))),m("div",{className:"Form-group"},L.a.component({state:this.composerLocaleDefault,onchange:function(n){return t.composerLocaleDefault=n}},app.translator.trans("fof-discussion-language.admin.settings.composer_default_label"))),m("div",{className:"Form-group"},L.a.component({state:this.localeSort,onchange:function(n){return t.localeSort=n}},app.translator.trans("fof-discussion-language.admin.settings.locale_sort_label"))),m("div",{className:"Form-group"},L.a.component({state:this.showAnyLangOpt,onchange:function(n){return t.showAnyLangOpt=n}},app.translator.trans("fof-discussion-language.admin.settings.show_any_lang_opt_label"))),m("hr",null),this.loadingData?m(O.a,null):m("form",null,m("div",{className:"Form-group flex"},w.a.component({onchange:this.newLocale,value:this.newLocale(),options:n}),w.a.component({onchange:this.newCountry,value:this.newCountry(),options:e}),Object(M.a)(B(this.newCountry())),y.a.component({className:"Button Button--primary",onclick:this.add.bind(this),disabled:!this.newLocale()||!this.newCountry()||this.adding},j()(this.adding?"fas fa-spinner fa-spin":"fas fa-plus"))),m("div",{className:"Form-group"},app.store.all("discussion-languages").map((function(o){var a=o.id(),s=t.updating[a],r=t.deleting[a],i=t.countries[a]||o.country();return m("div",{className:"flex"},w.a.component({onchange:function(n){return t.codes[a]=n},value:t.codes[a]||o.code(),options:n,disabled:s||r}),w.a.component({onchange:function(n){return t.countries[a]=n},value:i,options:e,disabled:s||r}),Object(M.a)(B(i)),y.a.component({className:"Button Button--danger",disabled:r,onclick:t.remove.bind(t,o)},j()(r?"fas fa-spinner fa-spin":"fas fa-times")))}))),m("div",{className:"Form-group"},m(y.a,{type:"submit",className:"Button Button--primary",loading:this.loading,disabled:!this.isChanged(),onclick:this.save.bind(this)},app.translator.trans("core.admin.settings.submit_button"))))))]},o.onkeydown=function(t){"Enter"===t.key&&(this.add(),t.preventDefault())},o.add=function(){var t=this;if(!this.adding&&this.newLocale()){this.adding=!0;var n=this.newLocale(),e=this.newCountry();app.store.createRecord("discussion-languages").save({code:n,country:e}).then((function(){t.newLocale(""),t.adding=!1,m.redraw()})).catch((function(){return t.adding=!1}))}},o.save=function(t){var n,e=this;t.preventDefault(),this.loading=!0,Promise.all([].concat(this.dirty().map((function(t){var n=t.id();return e.updating[n]=!0,t.save({code:e.codes[n],country:e.countries[n]}).then((function(){}),(function(){})).then((function(){e.updating[n]=!1}))})),[F()((n={},n[this.nativeKey]=this.native,n[this.showFlagsKey]=this.showFlags,n[this.composerLocaleDefaultKey]=this.composerLocaleDefault,n[this.localeSortKey]=this.localeSort,n[this.showAnyLangOptKey]=this.showAnyLangOpt,n)).then(this.onsaved.bind(this))]))},o.remove=function(t){var n=this;this.deleting[t.id()]=!0,t.delete().then((function(){}),(function(){})).then((function(){delete n.deleting[t.id()],m.redraw()}))},o.dirty=function(){var t=this;return app.store.all("discussion-languages").filter((function(n){var e=n.id();return t.codes[e]&&t.codes[e]!==n.code()||t.countries[e]&&t.countries[e]!==n.country()}))},o.isChanged=function(){var t=this.dirty().length,n=Number(this.native)!==Number(app.data.settings[this.nativeKey]||0),e=Number(this.showFlags)!==Number(app.data.settings[this.showFlagsKey]||0),o=Number(this.composerLocaleDefault)!==Number(app.data.settings[this.composerLocaleDefaultKey]||0),a=Number(this.localeSort)!==Number(app.data.settings[this.localeSortKey]||0),s=Number(this.showAnyLangOpt)!==Number(app.data.settings[this.showAnyLangOptKey]||0);return t||n||e||o||a||s},n}(h.a),I=e(6),q={LanguagesSettingsPage:T};function z(){return(z=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t}).apply(this,arguments)}var J=e(11),R=z({getCountry:E,countries:o,locales:C,getName:function(t,n){var e,o;return null==(e=a)||null==(o=e[n?"getNativeName":"getName"])?void 0:o.call(e,t)}},J.a),U=e(10);app.initializers.add("fof/discussion-language",(function(){app.store.models["discussion-languages"]=I.a,u.a.prototype.discussionLanguages=u.a.hasMany("discussionLanguages"),app.extensionData.for("fof-discussion-language").registerPage(T),Object(r.extend)(l.a.prototype,"startItems",(function(t){t.add("allowLanguageChange",{icon:"fas fa-globe",label:app.translator.trans("fof-discussion-language.admin.permissions.allow_change_language_label"),setting:function(){var t=parseInt(app.data.settings["fof-discussion-language.allow_tag_change"],10);return f.a.component({defaultLabel:t?app.translator.trans("core.admin.permissions_controls.allow_some_minutes_button",t,{count:t}):app.translator.trans("core.admin.permissions_controls.allow_indefinitely_button"),key:"fof-discussion-language.allow_language_change",options:[{value:"-1",label:app.translator.trans("core.admin.permissions_controls.allow_indefinitely_button")},{value:"10",label:app.translator.trans("core.admin.permissions_controls.allow_ten_minutes_button")},{value:"reply",label:app.translator.trans("core.admin.permissions_controls.allow_until_reply_button")}]})}},90)}))}))}]);
//# sourceMappingURL=admin.js.map